name: Test Enivornment Workflow

on:
  workflow_dispatch:
    inputs:
      message:
        description: 'Custom message (optional)'
        required: false
        default: 'Workflow triggered successfully!'

jobs:
  run-github-actions:
    runs-on: ubuntu-latest
    steps:
      - name: checkout repo
        uses: actions/checkout@v4
      - name: Present Working Directory
        run: |
            pwd
            ls -a
            echo $GITHUB_SHA
            echo $GITHUB_REPOSITORY
            echo $GITHUB_WORKSPACE
            echo "${{ github.token }}"
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install requests
    
      - name: "Print Build Config File."
        run: |
            python hello.py
        shell: bash
      
      - name: Print all environment variables
        run: printenv
        shell: bash

      - name: Send email notification
        env:
          GITHUB_TOKEN: ${{ secrets.OWR_GITHUB_EMAIL }}
          SENDER_EMAIL: ${{ vars.OWR_SENDER_EMAIL }}
          SENDER_PASSWORD: ${{ secrets.SENDER_PASSWORD }}
          SMTP_SERVER: ${{ secrets.SMTP_SERVER || 'smtp.intel.com' }}
          SMTP_PORT: ${{ secrets.SMTP_PORT || '25' }}
          CUSTOM_MESSAGE: ${{ github.event.inputs.message }}
        run: python send_email.py
